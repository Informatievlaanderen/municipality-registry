CREATE OR REPLACE STREAM IF NOT EXISTS MUNICIPALITY_SNAPSHOT_OSLO_STREAM_FLATTEN_GRB
WITH (KAFKA_TOPIC='stg.municipality.snapshot.oslo.flatten.grb', PARTITIONS=6, VALUE_FORMAT='JSON_SR') 
AS SELECT
  IDENTIFICATOR->OBJECTID Niscode,
  IFNULL(FILTER(GEMEENTENAMEN, (X) => (X->TAAL = 'nl'))[1]->SPELLING,
    IFNULL(FILTER(GEMEENTENAMEN, (X) => (X->TAAL = 'fr'))[1]->SPELLING,
      FILTER(GEMEENTENAMEN, (X) => (X->TAAL = 'de'))[1]->SPELLING)) as Gemeente,
  0 as Removed
FROM MUNICIPALITY_SNAPSHOT_OSLO_STREAM;
